#!/usr/bin/env perl

use Rex::ShellExtension;

my $command = "mount";

my $r = Rex::ShellExtension->new;

my $exit_code = 0;

eval {
   $exit_code = $r->call($command, mod_args => sub {
      my ($key, $val) = @_;
      if($key =~ m/^\// && $val == 1) {
         return undef;
      }

      if($key eq "options") {
         return [ split /,/, $val ];
      }

      return $val;
   });
   1;
} or do {
   print STDERR "$@\n";
   $exit_code = 1;
};


exit $exit_code;
